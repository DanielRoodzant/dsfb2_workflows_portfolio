<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>C. elegans plate experiment | R portfolio Daniël Roodzant</title>
  <meta name="description" content="C. elegans plate experiment | R portfolio Daniël Roodzant" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="C. elegans plate experiment | R portfolio Daniël Roodzant" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="DanielRoodzantHU/dsfb2_workflows_portfolio" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="C. elegans plate experiment | R portfolio Daniël Roodzant" />
  
  
  

<meta name="author" content="Daniël Roodzant" />


<meta name="date" content="2021-07-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="open-peer-review.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="c-elegans-plate-experiment.html"><a href="c-elegans-plate-experiment.html"><i class="fa fa-check"></i>C. elegans plate experiment</a></li>
<li class="chapter" data-level="" data-path="open-peer-review.html"><a href="open-peer-review.html"><i class="fa fa-check"></i>Open Peer Review</a></li>
<li class="chapter" data-level="" data-path="guerrilla-analytics-framework.html"><a href="guerrilla-analytics-framework.html"><i class="fa fa-check"></i>Guerrilla analytics framework</a></li>
<li class="chapter" data-level="" data-path="projecticum-princes-maxima-center.html"><a href="projecticum-princes-maxima-center.html"><i class="fa fa-check"></i>Projecticum Princes Maxima Center</a>
<ul>
<li class="chapter" data-level="" data-path="projecticum-princes-maxima-center.html"><a href="projecticum-princes-maxima-center.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="relational-databases.html"><a href="relational-databases.html"><i class="fa fa-check"></i>Relational databases</a>
<ul>
<li class="chapter" data-level="" data-path="relational-databases.html"><a href="relational-databases.html#intro"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="" data-path="relational-databases.html"><a href="relational-databases.html#cleaning-up"><i class="fa fa-check"></i>Cleaning up</a></li>
<li class="chapter" data-level="" data-path="relational-databases.html"><a href="relational-databases.html#using-dbeaver-sql"><i class="fa fa-check"></i>Using DBeaver SQL</a></li>
<li class="chapter" data-level="" data-path="relational-databases.html"><a href="relational-databases.html#joining-the-data"><i class="fa fa-check"></i>Joining the data</a></li>
<li class="chapter" data-level="" data-path="relational-databases.html"><a href="relational-databases.html#visualising-the-data"><i class="fa fa-check"></i>Visualising the data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="parameterized-data.html"><a href="parameterized-data.html"><i class="fa fa-check"></i>Parameterized data</a></li>
<li class="chapter" data-level="" data-path="looking-ahead.html"><a href="looking-ahead.html"><i class="fa fa-check"></i>Looking ahead</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R portfolio Daniël Roodzant</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="c.-elegans-plate-experiment" class="section level1">
<h1>C. elegans plate experiment</h1>
<p>The data for this exercise was kindly supplied by J. Louter (INT/ILC) and was derived from an experiment in which adult C.elegans nematodes were exposed to varying concentrations of different compounds. The variables RawData (the outcome - number of offspring counted as an integer value, after incubation time), compName (the generic name of the compound/chemical), the compConcentration (the concentration of the compound), and the expType are the most important variables in this dataset.
<br> <br>
A typical analysis with this data would be to run a dose-response analysis using a log-logistic model with estimates for the maximal, the minimal, the IC50 concentration and the slope at IC50. We will not go into the details but a good package to run such computations and create graphs in R is the {drc} package.
<br> <br> <br>
Lets have a look at the excel file containing the data.
<br>
<img src="data/data_raw/Untidy_example.png" alt="Untidy_example" />
<br>
We can see that someone put a lot of care into the make-up of the sheet and it is still difficult to read.
<br> <br>
Now lets open the Excel file in R and render the first five rows.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="c-elegans-plate-experiment.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the excel file into a vector and display it in a small table.</span></span>
<span id="cb2-2"><a href="c-elegans-plate-experiment.html#cb2-2" aria-hidden="true" tabindex="-1"></a>scatter_FLOW<span class="fl">.062</span> <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&#39;data/data_raw/CE.LIQ.FLOW.062_Tidydata.xlsx&#39;</span>) </span>
<span id="cb2-3"><a href="c-elegans-plate-experiment.html#cb2-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>( scatter_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="1%" />
<col width="2%" />
<col width="2%" />
<col width="3%" />
<col width="2%" />
<col width="6%" />
<col width="1%" />
<col width="1%" />
<col width="3%" />
<col width="1%" />
<col width="2%" />
<col width="5%" />
<col width="3%" />
<col width="1%" />
<col width="2%" />
<col width="3%" />
<col width="2%" />
<col width="2%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="2%" />
<col width="1%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">plateRow</th>
<th align="left">plateColumn</th>
<th align="right">vialNr</th>
<th align="left">dropCode</th>
<th align="left">expType</th>
<th align="right">expReplicate</th>
<th align="left">expName</th>
<th align="left">expDate</th>
<th align="left">expResearcher</th>
<th align="right">expTime</th>
<th align="left">expUnit</th>
<th align="right">expVolumeCounted</th>
<th align="right">RawData</th>
<th align="left">compCASRN</th>
<th align="left">compName</th>
<th align="left">compConcentration</th>
<th align="left">compUnit</th>
<th align="left">compDelivery</th>
<th align="left">compVehicle</th>
<th align="left">elegansStrain</th>
<th align="right">elegansInput</th>
<th align="left">bacterialStrain</th>
<th align="left">bacterialTreatment</th>
<th align="right">bacterialOD600</th>
<th align="right">bacterialConcX</th>
<th align="right">bacterialVolume</th>
<th align="left">bacterialVolUnit</th>
<th align="left">incubationVial</th>
<th align="right">incubationVolume</th>
<th align="left">incubationUnit</th>
<th align="left">incubationMethod</th>
<th align="right">incubationRPM</th>
<th align="left">bubble</th>
<th align="right">incubateTemperature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="left">a</td>
<td align="left">experiment</td>
<td align="right">3</td>
<td align="left">CE.LIQ.FLOW.062</td>
<td align="left">2020-11-30</td>
<td align="left">Sergio Reijnders - Ellis Herder</td>
<td align="right">68</td>
<td align="left">hour</td>
<td align="right">50</td>
<td align="right">44</td>
<td align="left">24157-81-1</td>
<td align="left">2,6-diisopropylnaphthalene</td>
<td align="left">4.99</td>
<td align="left">nM</td>
<td align="left">Liquid</td>
<td align="left">controlVehicleA</td>
<td align="left">N2</td>
<td align="right">25</td>
<td align="left">OP50</td>
<td align="left">heated</td>
<td align="right">0.743</td>
<td align="right">8</td>
<td align="right">300</td>
<td align="left">ul</td>
<td align="left">1,5 glass vial</td>
<td align="right">1000</td>
<td align="left">ul</td>
<td align="left">rockroll</td>
<td align="right">35</td>
<td align="left">NA</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="left">b</td>
<td align="left">experiment</td>
<td align="right">3</td>
<td align="left">CE.LIQ.FLOW.062</td>
<td align="left">2020-11-30</td>
<td align="left">Sergio Reijnders - Ellis Herder</td>
<td align="right">68</td>
<td align="left">hour</td>
<td align="right">50</td>
<td align="right">37</td>
<td align="left">24157-81-1</td>
<td align="left">2,6-diisopropylnaphthalene</td>
<td align="left">4.99</td>
<td align="left">nM</td>
<td align="left">Liquid</td>
<td align="left">controlVehicleA</td>
<td align="left">N2</td>
<td align="right">25</td>
<td align="left">OP50</td>
<td align="left">heated</td>
<td align="right">0.743</td>
<td align="right">8</td>
<td align="right">300</td>
<td align="left">ul</td>
<td align="left">1,5 glass vial</td>
<td align="right">1000</td>
<td align="left">ul</td>
<td align="left">rockroll</td>
<td align="right">35</td>
<td align="left">NA</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="left">c</td>
<td align="left">experiment</td>
<td align="right">3</td>
<td align="left">CE.LIQ.FLOW.062</td>
<td align="left">2020-11-30</td>
<td align="left">Sergio Reijnders - Ellis Herder</td>
<td align="right">68</td>
<td align="left">hour</td>
<td align="right">50</td>
<td align="right">45</td>
<td align="left">24157-81-1</td>
<td align="left">2,6-diisopropylnaphthalene</td>
<td align="left">4.99</td>
<td align="left">nM</td>
<td align="left">Liquid</td>
<td align="left">controlVehicleA</td>
<td align="left">N2</td>
<td align="right">25</td>
<td align="left">OP50</td>
<td align="left">heated</td>
<td align="right">0.743</td>
<td align="right">8</td>
<td align="right">300</td>
<td align="left">ul</td>
<td align="left">1,5 glass vial</td>
<td align="right">1000</td>
<td align="left">ul</td>
<td align="left">rockroll</td>
<td align="right">35</td>
<td align="left">NA</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="left">d</td>
<td align="left">experiment</td>
<td align="right">3</td>
<td align="left">CE.LIQ.FLOW.062</td>
<td align="left">2020-11-30</td>
<td align="left">Sergio Reijnders - Ellis Herder</td>
<td align="right">68</td>
<td align="left">hour</td>
<td align="right">50</td>
<td align="right">47</td>
<td align="left">24157-81-1</td>
<td align="left">2,6-diisopropylnaphthalene</td>
<td align="left">4.99</td>
<td align="left">nM</td>
<td align="left">Liquid</td>
<td align="left">controlVehicleA</td>
<td align="left">N2</td>
<td align="right">25</td>
<td align="left">OP50</td>
<td align="left">heated</td>
<td align="right">0.743</td>
<td align="right">8</td>
<td align="right">300</td>
<td align="left">ul</td>
<td align="left">1,5 glass vial</td>
<td align="right">1000</td>
<td align="left">ul</td>
<td align="left">rockroll</td>
<td align="right">35</td>
<td align="left">NA</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="left">e</td>
<td align="left">experiment</td>
<td align="right">3</td>
<td align="left">CE.LIQ.FLOW.062</td>
<td align="left">2020-11-30</td>
<td align="left">Sergio Reijnders - Ellis Herder</td>
<td align="right">68</td>
<td align="left">hour</td>
<td align="right">50</td>
<td align="right">41</td>
<td align="left">24157-81-1</td>
<td align="left">2,6-diisopropylnaphthalene</td>
<td align="left">4.99</td>
<td align="left">nM</td>
<td align="left">Liquid</td>
<td align="left">controlVehicleA</td>
<td align="left">N2</td>
<td align="right">25</td>
<td align="left">OP50</td>
<td align="left">heated</td>
<td align="right">0.743</td>
<td align="right">8</td>
<td align="right">300</td>
<td align="left">ul</td>
<td align="left">1,5 glass vial</td>
<td align="right">1000</td>
<td align="left">ul</td>
<td align="left">rockroll</td>
<td align="right">35</td>
<td align="left">NA</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p><br> <br>
And have a look at the data types.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="c-elegans-plate-experiment.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the data type of select columns</span></span>
<span id="cb3-2"><a href="c-elegans-plate-experiment.html#cb3-2" aria-hidden="true" tabindex="-1"></a>scatter_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> <span class="fu">select</span>(RawData, compName, compConcentration) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   RawData compName                   compConcentration
##     &lt;dbl&gt; &lt;chr&gt;                      &lt;chr&gt;            
## 1      44 2,6-diisopropylnaphthalene 4.99</code></pre>
<p><br>
When we have a look at some of the data types of the collumns RawData, compName and compConcentration (see above) we would expect them to be dbl, chr and dbl. compConcentration however, has the datatype chr. This means it was imported incorrectly.
<br> <br>
Next we will create a scatterplot graph with the data for the different compounds and the varying concentrations.
<br>
To do this I first fixed the compConcentration column by making it numeric, put the compConcentration on the x-axis, the RawData counts on the y-axis and assigned a color to each level in compName. I also assigned a different symbol to each level by the expType variable.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="c-elegans-plate-experiment.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the datatype of compConcentration to dbl</span></span>
<span id="cb5-2"><a href="c-elegans-plate-experiment.html#cb5-2" aria-hidden="true" tabindex="-1"></a>scatter_FLOW<span class="fl">.062</span> <span class="ot">&lt;-</span> scatter_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> <span class="fu">transform</span>(<span class="at">compConcentration =</span> <span class="fu">as.double</span>(compConcentration))</span>
<span id="cb5-3"><a href="c-elegans-plate-experiment.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="c-elegans-plate-experiment.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting data using ggplot</span></span>
<span id="cb5-5"><a href="c-elegans-plate-experiment.html#cb5-5" aria-hidden="true" tabindex="-1"></a>scatter_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> compConcentration, <span class="at">y =</span> RawData)) <span class="sc">+</span> </span>
<span id="cb5-6"><a href="c-elegans-plate-experiment.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> compName, <span class="at">shape =</span> expType)) <span class="sc">+</span> </span>
<span id="cb5-7"><a href="c-elegans-plate-experiment.html#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Compound RawData per compound concentration&quot;</span>,</span>
<span id="cb5-8"><a href="c-elegans-plate-experiment.html#cb5-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data supplied by J. Louter (INT/ILC)&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/1.1.d-1.png" width="672" />
<br> <br>
If I would not have changed the data type of the compConcentration column this would have happened:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="c-elegans-plate-experiment.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show example of the wrong graph from unedited .xlsx format by retrieving data</span></span>
<span id="cb6-2"><a href="c-elegans-plate-experiment.html#cb6-2" aria-hidden="true" tabindex="-1"></a>wrong_scatter_FLOW<span class="fl">.062</span> <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&#39;data/data_raw/CE.LIQ.FLOW.062_Tidydata.xlsx&#39;</span>)</span>
<span id="cb6-3"><a href="c-elegans-plate-experiment.html#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="c-elegans-plate-experiment.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting data using ggplot</span></span>
<span id="cb6-5"><a href="c-elegans-plate-experiment.html#cb6-5" aria-hidden="true" tabindex="-1"></a>wrong_scatter_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> compConcentration, <span class="at">y =</span> RawData)) <span class="sc">+</span> </span>
<span id="cb6-6"><a href="c-elegans-plate-experiment.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> compName, <span class="at">shape =</span> expType)) <span class="sc">+</span> </span>
<span id="cb6-7"><a href="c-elegans-plate-experiment.html#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Compound RawData per compound concentration&quot;</span>,</span>
<span id="cb6-8"><a href="c-elegans-plate-experiment.html#cb6-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data supplied by J. Louter (INT/ILC)&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/1.1.e-1.png" width="672" />
<br>
Every concentration is seen as a separate point because the column has the ‘chr’ type.
<br> <br>
Now, with the correct data types we will tweak the graph using a log10 transformation on the x-axis to get a clear graph. I also added a bit of jitter to prevent the points in the graph from overlapping.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="c-elegans-plate-experiment.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot data using log10 function in ggplot</span></span>
<span id="cb7-2"><a href="c-elegans-plate-experiment.html#cb7-2" aria-hidden="true" tabindex="-1"></a>scatter_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> compConcentration, <span class="at">y =</span> RawData)) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="c-elegans-plate-experiment.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb7-4"><a href="c-elegans-plate-experiment.html#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> compName, <span class="at">shape =</span> expType), <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="c-elegans-plate-experiment.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb7-6"><a href="c-elegans-plate-experiment.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Compound RawData per compound concentration&quot;</span>,</span>
<span id="cb7-7"><a href="c-elegans-plate-experiment.html#cb7-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data supplied by J. Louter (INT/ILC)&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/1.1.f-1.png" width="672" />
<br>
The positive control for this experiments is ethanol. The negative control for this experiment is S-medium.
<br> <br>
To analyze this experiment and learn whether there is indeed an effect of different concentrations on offspring count and whether the different compounds have a different curve (IC50) I would take these steps:
<br>
- Group the data for every compound. <br>
- Check if the data is normally distributed. <br>
- Use the apropriate statistical tests on the data to see if there is a statistically significant effect of different concentrations on the offspring count. <br>
- Calculate the IC50 and create a plot of the curve. <br>
<br> <br>
For the next vizualization of the data I have normalised the data
Normalize the data for the controlNegative in such a way that the mean value for controlNegative is exactly equal to 1 and that all other values are expressed as a fraction thereof. Rerun your graphs with the normalized data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="c-elegans-plate-experiment.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean of the RawData</span></span>
<span id="cb8-2"><a href="c-elegans-plate-experiment.html#cb8-2" aria-hidden="true" tabindex="-1"></a>mean_data_FLOW<span class="fl">.062</span> <span class="ot">&lt;-</span> scatter_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="c-elegans-plate-experiment.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(expType, RawData, compName, compConcentration) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="c-elegans-plate-experiment.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(expType) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="c-elegans-plate-experiment.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(expType <span class="sc">==</span> <span class="st">&#39;controlNegative&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="c-elegans-plate-experiment.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_RawData =</span> <span class="fu">mean</span>(RawData, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb8-7"><a href="c-elegans-plate-experiment.html#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="c-elegans-plate-experiment.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalise the RawData using the calculated mean</span></span>
<span id="cb8-9"><a href="c-elegans-plate-experiment.html#cb8-9" aria-hidden="true" tabindex="-1"></a>normalized_FLOW<span class="fl">.062</span> <span class="ot">&lt;-</span> scatter_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="c-elegans-plate-experiment.html#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(expType, compName, compConcentration, RawData) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="c-elegans-plate-experiment.html#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RawData_normalized =</span> RawData <span class="sc">/</span> mean_data_FLOW<span class="fl">.062</span><span class="sc">$</span>mean_RawData)</span>
<span id="cb8-12"><a href="c-elegans-plate-experiment.html#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="c-elegans-plate-experiment.html#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean of the normalised data</span></span>
<span id="cb8-14"><a href="c-elegans-plate-experiment.html#cb8-14" aria-hidden="true" tabindex="-1"></a>mean_normalized_FLOW<span class="fl">.062</span> <span class="ot">&lt;-</span> normalized_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(expType, compName, compConcentration) <span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="c-elegans-plate-experiment.html#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_RawData_normalized =</span> <span class="fu">mean</span>(RawData_normalized, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb8-16"><a href="c-elegans-plate-experiment.html#cb8-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mean_normalized_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">expType</th>
<th align="left">compName</th>
<th align="right">compConcentration</th>
<th align="right">mean_RawData_normalized</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">controlNegative</td>
<td align="left">S-medium</td>
<td align="right">0.00e+00</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="left">controlPositive</td>
<td align="left">Ethanol</td>
<td align="right">1.50e+00</td>
<td align="right">0.5750873</td>
</tr>
<tr class="odd">
<td align="left">controlVehicleA</td>
<td align="left">Ethanol</td>
<td align="right">5.00e-01</td>
<td align="right">1.0690726</td>
</tr>
<tr class="even">
<td align="left">experiment</td>
<td align="left">2,6-diisopropylnaphthalene</td>
<td align="right">4.99e-05</td>
<td align="right">1.0391929</td>
</tr>
<tr class="odd">
<td align="left">experiment</td>
<td align="left">2,6-diisopropylnaphthalene</td>
<td align="right">4.99e-04</td>
<td align="right">0.9670159</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="c-elegans-plate-experiment.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the normalised mean using ggplot</span></span>
<span id="cb9-2"><a href="c-elegans-plate-experiment.html#cb9-2" aria-hidden="true" tabindex="-1"></a>mean_normalized_FLOW<span class="fl">.062</span> <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> compConcentration, <span class="at">y =</span> mean_RawData_normalized)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="c-elegans-plate-experiment.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb9-4"><a href="c-elegans-plate-experiment.html#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> compName, <span class="at">shape =</span> expType), <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="c-elegans-plate-experiment.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Normalized mean compound RawData per compound concentration&quot;</span>,</span>
<span id="cb9-6"><a href="c-elegans-plate-experiment.html#cb9-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data supplied by J. Louter (INT/ILC)&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/1.1.j-1.png" width="672" />
<br>
I took this step to get the result in relation to the ‘0 value’ which makes it easier to compare the samples to the “normal” value.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="open-peer-review.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlights": true
}
});
});
</script>

</body>

</html>
