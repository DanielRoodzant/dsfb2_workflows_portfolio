<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>6 Relational databases | R portfolio Daniël Roodzant</title>
<meta name="author" content="Daniël Roodzant">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="6 Relational databases | R portfolio Daniël Roodzant">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="6 Relational databases | R portfolio Daniël Roodzant">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><meta name="description" content="6.1 Intro This page is about datasets on flu and dengue occurrences between 2002 and 2015 as measured by Google Webservices “Google Flu Trends” and “Google Dengue Trends.” These webservices track...">
<meta property="og:description" content="6.1 Intro This page is about datasets on flu and dengue occurrences between 2002 and 2015 as measured by Google Webservices “Google Flu Trends” and “Google Dengue Trends.” These webservices track...">
<meta name="twitter:description" content="6.1 Intro This page is about datasets on flu and dengue occurrences between 2002 and 2015 as measured by Google Webservices “Google Flu Trends” and “Google Dengue Trends.” These webservices track...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R portfolio Daniël Roodzant</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="c.-elegans-plate-experiment.html"><span class="header-section-number">2</span> C. elegans plate experiment</a></li>
<li><a class="" href="open-peer-review.html"><span class="header-section-number">3</span> Open Peer Review</a></li>
<li><a class="" href="guerrilla-analytics-framework.html"><span class="header-section-number">4</span> Guerrilla analytics framework</a></li>
<li><a class="" href="projecticum-princes-maxima-center.html"><span class="header-section-number">5</span> Projecticum Princes Maxima Center</a></li>
<li><a class="active" href="relational-databases.html"><span class="header-section-number">6</span> Relational databases</a></li>
<li><a class="" href="parameterized-data.html"><span class="header-section-number">7</span> Parameterized data</a></li>
<li><a class="" href="looking-ahead.html"><span class="header-section-number">8</span> Looking ahead</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/DanielRoodzant/dsfb2_workflows_portfolio">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="relational-databases" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Relational databases<a class="anchor" aria-label="anchor" href="#relational-databases"><i class="fas fa-link"></i></a>
</h1>
<div id="intro" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Intro<a class="anchor" aria-label="anchor" href="#intro"><i class="fas fa-link"></i></a>
</h2>
<p>This page is about datasets on flu and dengue occurrences between 2002 and 2015 as measured by Google Webservices “Google Flu Trends” and “Google Dengue Trends.” These webservices track searches of the words flu and dengue in different countries and match them to occurrences of the diseases in these countries. The data will be compared to the “gapminder” dataset that is part of the R package dslabs.
<br><br>
Data Source: <br>
(Google sites are unfortunately no longer operational) <br>
- Google Flu Trends (<a href="http://www.google.org/flutrends" class="uri">http://www.google.org/flutrends</a>) <br>
- Google Dengue Trends (<a href="http://www.google.org/denguetrends" class="uri">http://www.google.org/denguetrends</a>) <br>
- <a href="https://www.rdocumentation.org/packages/dslabs/versions/0.7.4">dslabs package</a>
<br><br>
Datasets used: <br>
- <a href="data_raw/005_relational_databases/flu_data.csv">Flu data</a> <br>
- <a href="data_raw/005_relational_databases/dengue_data.csv">Dengue data</a> <br>
- <a href="data_raw/005_relational_databases/gapminder.csv">gapminder</a>
<br></p>
</div>
<div id="cleaning-up" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Cleaning up<a class="anchor" aria-label="anchor" href="#cleaning-up"><i class="fas fa-link"></i></a>
</h2>
<p>Before any comparisons can be made the data must be tidied and the column types must be matching. <br>
The gapminder dataset is also very large and includes a large number of years not present in the flu and dengue datasets. These years also need to be removed from the dataset. <br>
The next section will show how this was achieved:
<br></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the datasets into R datframes</span>
<span class="va">flu_data</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/data_raw/005_relational_databases/flu_data.csv"</span><span class="op">)</span>, skip <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">%&gt;%</span>
                              <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">dengue_data</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/data_raw/005_relational_databases/dengue_data.csv"</span><span class="op">)</span>, skip <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">%&gt;%</span>
                                 <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">gapminder</span> <span class="op">&lt;-</span> <span class="fu">dslabs</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/dslabs/man/gapminder.html">gapminder</a></span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span>

<span class="co"># Tidy the flu_data and dengue_data datasets</span>
<span class="va">flu_data</span> <span class="op">&lt;-</span> <span class="va">flu_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">Argentina</span><span class="op">:</span><span class="va">Uruguay</span>,
                      names_to <span class="op">=</span> <span class="st">"country"</span>, 
                      values_to <span class="op">=</span> <span class="st">"searches"</span>
                      <span class="op">)</span>
<span class="va">dengue_data</span> <span class="op">&lt;-</span> <span class="va">dengue_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">Argentina</span><span class="op">:</span><span class="va">Venezuela</span>,
                      names_to <span class="op">=</span> <span class="st">"country"</span>, 
                      values_to <span class="op">=</span> <span class="st">"searches"</span>
                      <span class="op">)</span>

<span class="co"># Match the column types of the datasets</span>
<span class="co"># The coltrans() function is from the drporthelp package that was created for this portfolio</span>
<span class="va">flu_data</span> <span class="op">&lt;-</span> <span class="fu">drporthelp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/drporthelp/man/coltrans.html">coltrans</a></span><span class="op">(</span><span class="va">flu_data</span><span class="op">)</span>
<span class="va">dengue_data</span> <span class="op">&lt;-</span> <span class="fu">drporthelp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/drporthelp/man/coltrans.html">coltrans</a></span><span class="op">(</span><span class="va">dengue_data</span><span class="op">)</span>

<span class="va">gapminder</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op">%&gt;%</span>
  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Filter gapminder to contain only the years present in the flu and dengue dataseets</span>
<span class="va">gapminder</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span><span class="op">:</span><span class="fl">2015</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="using-dbeaver-sql" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Using DBeaver SQL<a class="anchor" aria-label="anchor" href="#using-dbeaver-sql"><i class="fas fa-link"></i></a>
</h2>
<p>Following the cleaning of the data, the datasets need to be saved in R and uploaded to DBeaver for further review using the following commands:
<br></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Save the data in .csv and .rds files</span>
<span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">flu_data</span>, <span class="st">"data/data_raw/005_relational_databases/flu_data_tidy.csv"</span><span class="op">)</span>
<span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">dengue_data</span>, <span class="st">"data/data_raw/005_relational_databases/dengue_data_tidy.csv"</span><span class="op">)</span>
<span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">gapminder</span>, <span class="st">"data/data_raw/005_relational_databases/gapminder.csv"</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">write_rds</a></span><span class="op">(</span><span class="va">flu_data</span>, <span class="st">"data/data_raw/005_relational_databases/flu_data_tidy.rds"</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">write_rds</a></span><span class="op">(</span><span class="va">dengue_data</span>, <span class="st">"data/data_raw/005_relational_databases/dengue_data_tidy.rds"</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">write_rds</a></span><span class="op">(</span><span class="va">gapminder</span>, <span class="st">"data/data_raw/005_relational_databases/gapminder.rds"</span><span class="op">)</span>

<span class="co">#Upload the data to DBeaver, con = the DBeaver connection created using the DBI::dbConnect() function</span>
<span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html">dbWriteTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"flu_data"</span>,
             <span class="va">flu_data</span>,
             overwrite <span class="op">=</span> <span class="cn">TRUE</span>
              <span class="op">)</span>
<span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html">dbWriteTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"dengue_data"</span>,
             <span class="va">dengue_data</span>,
             overwrite <span class="op">=</span> <span class="cn">TRUE</span>
              <span class="op">)</span>
<span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html">dbWriteTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"gapminder"</span>,
             <span class="va">gapminder</span>,
             overwrite <span class="op">=</span> <span class="cn">TRUE</span>
              <span class="op">)</span></code></pre></div>
<p><br>
Uploading files into DBeaver can come in handy to do things like: <br>
Using the SQL shell to obtain some information about the data in the tables <br><img src="data_raw/005_relational_databases/sql_shell.png" style="width:100.0%" alt="SQLshell"><br>
Using the console to get information from the data
<img src="data_raw/005_relational_databases/DBeaver_example.png" style="width:100.0%" alt="DBeaverexample"></p>
</div>
<div id="joining-the-data" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Joining the data<a class="anchor" aria-label="anchor" href="#joining-the-data"><i class="fas fa-link"></i></a>
</h2>
<p>Getting information from tables and forming them into something useful for visualizing data can also be done using R.
The Data needs to be joined together to make good informative figures. The next section shows how this was done followed by a preview of the newly formed table.
<br></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Make the data tables joinable</span>
<span class="co"># The datatrans() function is from the drporthelp package that was created for this portfolio</span>
<span class="va">flu_data</span> <span class="op">&lt;-</span> <span class="fu">drporthelp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/drporthelp/man/datatrans.html">datatrans</a></span><span class="op">(</span><span class="va">flu_data</span><span class="op">)</span>
<span class="va">dengue_data</span> <span class="op">&lt;-</span> <span class="fu">drporthelp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/drporthelp/man/datatrans.html">datatrans</a></span><span class="op">(</span><span class="va">dengue_data</span><span class="op">)</span>

<span class="co"># Join the data tables</span>
<span class="va">flu_dengue_data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">flu_data</span>, 
                                    <span class="va">dengue_data</span>, 
                                    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"year"</span><span class="op">)</span>, 
                                    suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"_flu"</span>, <span class="st">"_dengue"</span><span class="op">)</span>
                                    <span class="op">)</span>
<span class="va">gap_flu_dengue_data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">flu_dengue_data</span>, 
                                         <span class="va">gapminder</span>, 
                                         by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"year"</span><span class="op">)</span>
                                         <span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">gap_flu_dengue_data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="7%">
<col width="3%">
<col width="9%">
<col width="11%">
<col width="12%">
<col width="11%">
<col width="7%">
<col width="8%">
<col width="9%">
<col width="7%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">country</th>
<th align="left">year</th>
<th align="right">searches_flu</th>
<th align="right">searches_dengue</th>
<th align="right">infant_mortality</th>
<th align="right">life_expectancy</th>
<th align="right">fertility</th>
<th align="right">population</th>
<th align="right">gdp</th>
<th align="left">continent</th>
<th align="left">region</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Argentina</td>
<td align="left">2002</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">17.1</td>
<td align="right">74.3</td>
<td align="right">2.38</td>
<td align="right">37889443</td>
<td align="right">242076212334</td>
<td align="left">Americas</td>
<td align="left">South America</td>
</tr>
<tr class="even">
<td align="left">Argentina</td>
<td align="left">2003</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">16.6</td>
<td align="right">74.5</td>
<td align="right">2.34</td>
<td align="right">38309475</td>
<td align="right">263468585945</td>
<td align="left">Americas</td>
<td align="left">South America</td>
</tr>
<tr class="odd">
<td align="left">Argentina</td>
<td align="left">2004</td>
<td align="right">8843</td>
<td align="right">1.53</td>
<td align="right">16.0</td>
<td align="right">75.0</td>
<td align="right">2.31</td>
<td align="right">38728778</td>
<td align="right">287258675094</td>
<td align="left">Americas</td>
<td align="left">South America</td>
</tr>
<tr class="even">
<td align="left">Argentina</td>
<td align="left">2005</td>
<td align="right">8627</td>
<td align="right">1.03</td>
<td align="right">15.3</td>
<td align="right">75.3</td>
<td align="right">2.29</td>
<td align="right">39145491</td>
<td align="right">313626005874</td>
<td align="left">Americas</td>
<td align="left">South America</td>
</tr>
<tr class="odd">
<td align="left">Argentina</td>
<td align="left">2006</td>
<td align="right">8966</td>
<td align="right">1.01</td>
<td align="right">14.6</td>
<td align="right">75.3</td>
<td align="right">2.27</td>
<td align="right">39558750</td>
<td align="right">340177780212</td>
<td align="left">Americas</td>
<td align="left">South America</td>
</tr>
</tbody>
</table></div>
</div>
<div id="visualising-the-data" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Visualising the data<a class="anchor" aria-label="anchor" href="#visualising-the-data"><i class="fas fa-link"></i></a>
</h2>
<p>After the data is joined together in one table it can be udes to create some figures:
<br><br>
First by plotting the occurrences of flu and dengue per region to see if they are more common in one region compared to the other.
<br></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot occurrences of flu and dengue per region</span>
<span class="va">flu_region</span> <span class="op">&lt;-</span> <span class="va">gap_flu_dengue_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_col</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, 
               y <span class="op">=</span> <span class="va">searches_flu</span>,
               fill <span class="op">=</span> <span class="va">region</span><span class="op">)</span>
           <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
        legend.position <span class="op">=</span> <span class="st">"none"</span>
        <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Flu searches per region"</span>, 
       subtitle <span class="op">=</span> <span class="st">"Searches of the word 'Flu' per region"</span>,
       x <span class="op">=</span> <span class="st">""</span>,
       y <span class="op">=</span> <span class="st">"Searches"</span>
       <span class="op">)</span>

<span class="va">dengue_region</span> <span class="op">&lt;-</span> <span class="va">gap_flu_dengue_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_col</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, 
               y <span class="op">=</span> <span class="va">searches_dengue</span>,
               fill <span class="op">=</span> <span class="va">region</span><span class="op">)</span>
           <span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
          legend.position <span class="op">=</span> <span class="st">"none"</span>
        <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Dengue searches per region"</span>, 
       subtitle <span class="op">=</span> <span class="st">"Searches of the word 'Dengue' per region"</span>,
       x <span class="op">=</span> <span class="st">""</span>,
       y <span class="op">=</span> <span class="st">"Searches"</span>
       <span class="op">)</span>

<span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">flu_region</span>, <span class="va">dengue_region</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/data%20visualisation%201-1.png" width="672"><br>
The data shows that dengue is most common in South America and South-Eastern Asia. It also has some presence in Central America and Southern Asia but not so much in other regions.
<br>
Flu appears to be most common in Eastern Europe, Western Europe and Northern America. Regions where it’s not very common are North- and Southern Europe and South America
<br><br>
The second graph will portray the occurrences of flu and dengue in the Netherlands over the period of 2002 to 2015.
<br></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot occurrences of flu and dengue in the Netherlands by year</span>
<span class="va">flu_region</span> <span class="op">&lt;-</span> <span class="va">gap_flu_dengue_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"Netherlands"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_col</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, 
               y <span class="op">=</span> <span class="va">searches_flu</span>,
               fill <span class="op">=</span> <span class="va">year</span><span class="op">)</span>
           <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
        legend.position <span class="op">=</span> <span class="st">"none"</span>
        <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Flu searches in the Netherlands"</span>, 
       subtitle <span class="op">=</span> <span class="st">"Searches of the word 'Flu' in the Netherlands"</span>,
       x <span class="op">=</span> <span class="st">"Year"</span>,
       y <span class="op">=</span> <span class="st">"Searches"</span>
       <span class="op">)</span>

<span class="va">dengue_region</span> <span class="op">&lt;-</span> <span class="va">gap_flu_dengue_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"Netherlands"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_col</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, 
               y <span class="op">=</span> <span class="va">searches_dengue</span>,
               fill <span class="op">=</span> <span class="va">year</span><span class="op">)</span>
           <span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
          legend.position <span class="op">=</span> <span class="st">"none"</span>
        <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Dengue searches in the Netherlands"</span>, 
       subtitle <span class="op">=</span> <span class="st">"Searches of the word 'Dengue' in the Netherlands"</span>,
       x <span class="op">=</span> <span class="st">"Year"</span>,
       y <span class="op">=</span> <span class="st">"Searches"</span>
       <span class="op">)</span>

<span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">flu_region</span>, <span class="va">dengue_region</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/data%20visualisation%202-1.png" width="672"><br>
The flu had its most occurrences in 2009 and 2013 and its least in 2004 and 2010. There is no flu data for 2002 and 2003. This could be because of a lack of data in these years. <br>
The data shows that Dengue has had no occurrences in the Netherlands between 2002 and 2015.
<br><br>
The third and last graph will show the worldwide occurrences of flu and dengue on a year to year basis. Showing what years these diseases were most common.
<br></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot occurrences of flu and dengue per year</span>
<span class="va">flu_region</span> <span class="op">&lt;-</span> <span class="va">gap_flu_dengue_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_col</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, 
               y <span class="op">=</span> <span class="va">searches_flu</span>,
               fill <span class="op">=</span> <span class="va">year</span><span class="op">)</span>
           <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
        legend.position <span class="op">=</span> <span class="st">"none"</span>
        <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Flu searches per year"</span>, 
       subtitle <span class="op">=</span> <span class="st">"Worldwide searches of the word 'Flu'"</span>,
       x <span class="op">=</span> <span class="st">"Year"</span>,
       y <span class="op">=</span> <span class="st">"Searches"</span>
       <span class="op">)</span>

<span class="va">dengue_region</span> <span class="op">&lt;-</span> <span class="va">gap_flu_dengue_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_col</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, 
               y <span class="op">=</span> <span class="va">searches_dengue</span>,
               fill <span class="op">=</span> <span class="va">year</span><span class="op">)</span>
           <span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
          legend.position <span class="op">=</span> <span class="st">"none"</span>
        <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Dengue searches per year"</span>, 
       subtitle <span class="op">=</span> <span class="st">"Worldwide searches of the word 'Dengue'"</span>,
       x <span class="op">=</span> <span class="st">"Year"</span>,
       y <span class="op">=</span> <span class="st">"Searches"</span>
       <span class="op">)</span>

<span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">flu_region</span>, <span class="va">dengue_region</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/data%20visualisation%203-1.png" width="672"><br>
The Flu had its most occurrences in 2009, same as in the Netherlands as shown in the previous graph. The least occurrences were in 2002, 2003 and 2004. This could be because of a lack of data in these years. The rest of the datapoints show only minor peaks. <br>
Dengue had its most occurrences in 2009 and 2010, and the least in 2002, 2003 and 2015. This could also be because of a lack of data in the first, and last few years of the survey.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="projecticum-princes-maxima-center.html"><span class="header-section-number">5</span> Projecticum Princes Maxima Center</a></div>
<div class="next"><a href="parameterized-data.html"><span class="header-section-number">7</span> Parameterized data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#relational-databases"><span class="header-section-number">6</span> Relational databases</a></li>
<li><a class="nav-link" href="#intro"><span class="header-section-number">6.1</span> Intro</a></li>
<li><a class="nav-link" href="#cleaning-up"><span class="header-section-number">6.2</span> Cleaning up</a></li>
<li><a class="nav-link" href="#using-dbeaver-sql"><span class="header-section-number">6.3</span> Using DBeaver SQL</a></li>
<li><a class="nav-link" href="#joining-the-data"><span class="header-section-number">6.4</span> Joining the data</a></li>
<li><a class="nav-link" href="#visualising-the-data"><span class="header-section-number">6.5</span> Visualising the data</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/DanielRoodzant/dsfb2_workflows_portfolio/blob/master/005_relational_databases.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/DanielRoodzant/dsfb2_workflows_portfolio/edit/master/005_relational_databases.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R portfolio Daniël Roodzant</strong>" was written by Daniël Roodzant. It was last built on 2022-06-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
